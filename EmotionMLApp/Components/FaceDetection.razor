@page "/face-detection"
@using System.Drawing
@using EmotionMLApp.Components
@inject FaceDetectionService FaceDetectionService

<h3>Face Detection</h3>

<input type="file" @onchange="LoadImage" />
@if (detectedFaces != null)
{
    <p>Detected Faces:</p>
    <ul>
        @foreach (var face in detectedFaces)
        {
            <li>@face</li>
        }
    </ul>
}

@code {
    private List<Rectangle> detectedFaces;

    private async Task LoadImage(ChangeEventArgs e)
    {
        var files = (e.Value as IReadOnlyList<IBrowserFile>)?.ToArray();
        if (files != null && files.Length > 0)
        {
            var file = files[0];
            using var stream = file.OpenReadStream();
            var bitmap = new Bitmap(stream);
            detectedFaces = FaceDetectionService.DetectFaces(bitmap);
        }
    }
}
